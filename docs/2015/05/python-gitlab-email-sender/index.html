<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <script type="application/ld+json">

{  
  "@context":"http://schema.org",
  "@type":"Website",
  "@id":"https:\/\/www.gokhanmankara.com",
  "author": {
    "@type": "Person",
    "name": "Gökhan MANKARA",
    
    "image": "https://www.gravatar.com/avatar/d5d65b23744b836690ba8e789bbf1656"
    
  },
  "name":"Gökhan MANKARA",
  "description":"Gitlab kullanıyor iseniz, gitlab sunucunuzdaki post-receive hook scriptinin içerisine, aşağıdaki python scriptini her push işleminden sonra çalıştıracak şekilde ayarlamanız durumunda, script her çalıştığında oluşturduğu commits.db sqlite database’indeki short commit’i ile karşılaştırıp, değişikli var ise aşağıdaki mail gönderim formatında maili ‘to@domain.com’ adresine gönderir. Eğer db’de bulunmayan bir repo ile karşılaşması durumunda db’ye repo’yu insert eder.\n#!\/usr\/bin\/env python __author__ = \u0026#34;Gokhan MANKARA \u0026lt;gokhan@mankara.org\u0026#34; import gitlab import sqlite3 as sql import requests import smtplib import os import email.",
  "url":"https:\/\/www.gokhanmankara.com\/2015\/05\/python-gitlab-email-sender\/",
  "keywords":"[]"
}

</script>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.88.1 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="Gökhan MANKARA">
<meta name="keywords" content="">
<meta name="description" content="Gitlab kullanıyor iseniz, gitlab sunucunuzdaki post-receive hook scriptinin içerisine, aşağıdaki python scriptini her push işleminden sonra çalıştıracak şekilde ayarlamanız durumunda, script her çalıştığında oluşturduğu commits.db sqlite database’indeki short commit’i ile karşılaştırıp, değişikli var ise aşağıdaki mail gönderim formatında maili ‘to@domain.com’ adresine gönderir. Eğer db’de bulunmayan bir repo ile karşılaşması durumunda db’ye repo’yu insert eder.
#!/usr/bin/env python __author__ = &#34;Gokhan MANKARA &lt;gokhan@mankara.org&#34; import gitlab import sqlite3 as sql import requests import smtplib import os import email.">


<meta property="og:description" content="Gitlab kullanıyor iseniz, gitlab sunucunuzdaki post-receive hook scriptinin içerisine, aşağıdaki python scriptini her push işleminden sonra çalıştıracak şekilde ayarlamanız durumunda, script her çalıştığında oluşturduğu commits.db sqlite database’indeki short commit’i ile karşılaştırıp, değişikli var ise aşağıdaki mail gönderim formatında maili ‘to@domain.com’ adresine gönderir. Eğer db’de bulunmayan bir repo ile karşılaşması durumunda db’ye repo’yu insert eder.
#!/usr/bin/env python __author__ = &#34;Gokhan MANKARA &lt;gokhan@mankara.org&#34; import gitlab import sqlite3 as sql import requests import smtplib import os import email.">
<meta property="og:type" content="article">
<meta property="og:title" content="Python - Gitlab Email Sender">
<meta name="twitter:title" content="Python - Gitlab Email Sender">
<meta property="og:url" content="https://www.gokhanmankara.com/2015/05/python-gitlab-email-sender/">
<meta property="twitter:url" content="https://www.gokhanmankara.com/2015/05/python-gitlab-email-sender/">
<meta property="og:site_name" content="Gökhan MANKARA">
<meta property="og:description" content="Gitlab kullanıyor iseniz, gitlab sunucunuzdaki post-receive hook scriptinin içerisine, aşağıdaki python scriptini her push işleminden sonra çalıştıracak şekilde ayarlamanız durumunda, script her çalıştığında oluşturduğu commits.db sqlite database’indeki short commit’i ile karşılaştırıp, değişikli var ise aşağıdaki mail gönderim formatında maili ‘to@domain.com’ adresine gönderir. Eğer db’de bulunmayan bir repo ile karşılaşması durumunda db’ye repo’yu insert eder.
#!/usr/bin/env python __author__ = &#34;Gokhan MANKARA &lt;gokhan@mankara.org&#34; import gitlab import sqlite3 as sql import requests import smtplib import os import email.">
<meta name="twitter:description" content="Gitlab kullanıyor iseniz, gitlab sunucunuzdaki post-receive hook scriptinin içerisine, aşağıdaki python scriptini her push işleminden sonra çalıştıracak şekilde ayarlamanız durumunda, script her çalıştığında oluşturduğu commits.db sqlite database’indeki short commit’i ile karşılaştırıp, değişikli var ise aşağıdaki mail gönderim formatında maili ‘to@domain.com’ adresine gönderir. Eğer db’de bulunmayan bir repo ile karşılaşması durumunda db’ye repo’yu insert eder.
#!/usr/bin/env python __author__ = &#34;Gokhan MANKARA &lt;gokhan@mankara.org&#34; import gitlab import sqlite3 as sql import requests import smtplib import os import email.">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2015-05-31T13:45:47">
  
  
    <meta property="article:modified_time" content="2015-05-31T13:45:47">
  
  
  
    
      <meta property="article:section" content="LKD-Gezegen">
    
      <meta property="article:section" content="Python">
    
  
  
    
      <meta property="article:tag" content="gitlab">
    
      <meta property="article:tag" content="gitlab hook">
    
      <meta property="article:tag" content="gitlab send email">
    
      <meta property="article:tag" content="python">
    
      <meta property="article:tag" content="python gitlab hook">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@gokhanmankara">


  <meta name="twitter:creator" content="@gokhanmankara">






  <meta property="og:image" content="https://www.gravatar.com/avatar/d5d65b23744b836690ba8e789bbf1656?s=640">
  <meta property="twitter:image" content="https://www.gravatar.com/avatar/d5d65b23744b836690ba8e789bbf1656?s=640">






    <title>Python - Gitlab Email Sender</title>

    <link rel="icon" href="https://www.gokhanmankara.com/favicon.png">
    

    

    <link rel="canonical" href="https://www.gokhanmankara.com/2015/05/python-gitlab-email-sender/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    
    
    <link rel="stylesheet" href="https://www.gokhanmankara.com/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css" />
    
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-10446851-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://www.gokhanmankara.com/" aria-label="Go to homepage">Gökhan MANKARA</a>
  </div>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://www.gokhanmankara.com/#about" aria-label="Read more about the author">
          <img class="sidebar-profile-picture" src="https://www.gravatar.com/avatar/d5d65b23744b836690ba8e789bbf1656?s=110" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">Gökhan MANKARA</h4>
        
          <h5 class="sidebar-profile-bio">Golang, Python, Blogger, Linux Fan</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.gokhanmankara.com/" title="Home">
    
      <i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.gokhanmankara.com/category" title="Category">
    
      <i class="sidebar-button-icon fas fa-lg fa-bookmark" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Category</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.gokhanmankara.com/tags" title="Tags">
    
      <i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.gokhanmankara.com/archive" title="Archive">
    
      <i class="sidebar-button-icon fas fa-lg fa-archive" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Archive</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/gokhanm" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/gokhanmankara" target="_blank" rel="noopener" title="Twitter">
    
      <i class="sidebar-button-icon fab fa-lg fa-twitter" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.linkedin.com/in/gokhanmankara/" target="_blank" rel="noopener" title="LinkedIn">
    
      <i class="sidebar-button-icon fab fa-lg fa-linkedin-in" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">LinkedIn</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.gokhanmankara.com/about" title="About">
    
      <i class="sidebar-button-icon fas fa-lg fa-user" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.gokhanmankara.com/index.xml" title="RSS">
    
      <i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      

    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" id="top">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title">
      Python - Gitlab Email Sender
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2015-05-31T13:45:47&#43;03:00">
        
  
  
  
  
    2015, May 31
  

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="https://www.gokhanmankara.com/categories/lkd-gezegen">LKD-Gezegen</a>, 
    
      <a class="category-link" href="https://www.gokhanmankara.com/categories/python">Python</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <p>Gitlab kullanıyor iseniz, gitlab sunucunuzdaki post-receive hook scriptinin içerisine, aşağıdaki python scriptini her push işleminden sonra çalıştıracak şekilde ayarlamanız durumunda, script her çalıştığında oluşturduğu <strong>commits.db</strong> sqlite database’indeki short commit’i ile karşılaştırıp, değişikli var ise aşağıdaki mail gönderim formatında maili <strong>‘to@domain.com’</strong> adresine gönderir. Eğer db’de bulunmayan bir repo ile karşılaşması durumunda db’ye repo’yu insert eder.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/env python</span>
__author__ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Gokhan MANKARA &lt;gokhan@mankara.org&#34;</span>

<span style="color:#f92672">import</span> gitlab
<span style="color:#f92672">import</span> sqlite3 <span style="color:#66d9ef">as</span> sql
<span style="color:#f92672">import</span> requests
<span style="color:#f92672">import</span> smtplib
<span style="color:#f92672">import</span> os
<span style="color:#f92672">import</span> email.utils
<span style="color:#f92672">from</span> email.mime.text <span style="color:#f92672">import</span> MIMEText

gitlab_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://gitlab.domain.com&#34;</span>
gitlab_access_token <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ABCDEFG&#34;</span>


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SendEmail</span>(object):
    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>mail_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;to@domain.com&#39;</span>
        self<span style="color:#f92672">.</span>mail_from <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;from@domain.com&#39;</span>
        self<span style="color:#f92672">.</span>mail_server <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;mail.domain.com&#39;</span>
        self<span style="color:#f92672">.</span>mail_subject <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;New Commit&#39;</span>

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>(self, msg):
        msg <span style="color:#f92672">=</span> MIMEText(msg)
        msg[<span style="color:#e6db74">&#39;To&#39;</span>] <span style="color:#f92672">=</span> email<span style="color:#f92672">.</span>utils<span style="color:#f92672">.</span>formataddr((<span style="color:#e6db74">&#39;Recipient&#39;</span>, self<span style="color:#f92672">.</span>mail_to))
        msg[<span style="color:#e6db74">&#39;From&#39;</span>] <span style="color:#f92672">=</span> email<span style="color:#f92672">.</span>utils<span style="color:#f92672">.</span>formataddr((self<span style="color:#f92672">.</span>mail_subject, self<span style="color:#f92672">.</span>mail_from))
        msg[<span style="color:#e6db74">&#39;Subject&#39;</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>mail_subject

        server <span style="color:#f92672">=</span> smtplib<span style="color:#f92672">.</span>SMTP(self<span style="color:#f92672">.</span>mail_server, <span style="color:#ae81ff">25</span>)
        server<span style="color:#f92672">.</span>set_debuglevel(<span style="color:#66d9ef">False</span>)

        <span style="color:#66d9ef">try</span>:
            server<span style="color:#f92672">.</span>sendmail(self<span style="color:#f92672">.</span>mail_from, self<span style="color:#f92672">.</span>mail_to, msg<span style="color:#f92672">.</span>as_string())
        <span style="color:#66d9ef">finally</span>:
            server<span style="color:#f92672">.</span>quit()


<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Commit</span>(object):
    <span style="color:#66d9ef">def</span> __init__(self):
        self<span style="color:#f92672">.</span>db <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;commits.db&#34;</span>
        self<span style="color:#f92672">.</span>con <span style="color:#f92672">=</span> sql<span style="color:#f92672">.</span>connect(self<span style="color:#f92672">.</span>db)
        self<span style="color:#f92672">.</span>git <span style="color:#f92672">=</span> gitlab<span style="color:#f92672">.</span>Gitlab(gitlab_url, token<span style="color:#f92672">=</span>gitlab_access_token, verify_ssl<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
        <span style="color:#66d9ef">with</span> self<span style="color:#f92672">.</span>con:
            self<span style="color:#f92672">.</span>cur <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>con<span style="color:#f92672">.</span>cursor()
        requests<span style="color:#f92672">.</span>packages<span style="color:#f92672">.</span>urllib3<span style="color:#f92672">.</span>disable_warnings()

        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>isfile(self<span style="color:#f92672">.</span>db):
            os<span style="color:#f92672">.</span>system(<span style="color:#e6db74">&#34;sqlite3 commits.db &lt; commits.sql&#34;</span>)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sql_insert</span>(self, repo, branch, hash):
        sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;insert into last_commit (&#39;repo&#39;, &#39;branch&#39;, &#39;hash&#39;) values (&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;, &#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;, &#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;)&#34;</span> <span style="color:#f92672">%</span> (repo, branch, hash)
        self<span style="color:#f92672">.</span>cur<span style="color:#f92672">.</span>execute(sql)
        self<span style="color:#f92672">.</span>con<span style="color:#f92672">.</span>commit()

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sql_select</span>(self, branch, repo):
        sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;select hash from `last_commit` where branch=&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39; and repo=&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;&#34;</span> <span style="color:#f92672">%</span> (branch, repo)
        self<span style="color:#f92672">.</span>cur<span style="color:#f92672">.</span>execute(sql)
        <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>cur<span style="color:#f92672">.</span>fetchone()[<span style="color:#ae81ff">0</span>]

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sql_update</span>(self, new_hash, branch, repo):
        sql <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;UPDATE last_commit SET hash=&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39; WHERE branch=&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39; and repo=&#39;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;&#34;</span> <span style="color:#f92672">%</span> (new_hash, branch, repo)
        self<span style="color:#f92672">.</span>cur<span style="color:#f92672">.</span>execute(sql)
        self<span style="color:#f92672">.</span>con<span style="color:#f92672">.</span>commit()

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">commits</span>(self):
        <span style="color:#75715e"># git.getprojectsall =&gt; Returns a dictionary of all the projects for admins only</span>
        <span style="color:#75715e"># git.getprojects =&gt; Returns a dictionary of all the projects</span>

        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>git<span style="color:#f92672">.</span>getprojectsall():
            group_name <span style="color:#f92672">=</span> i[<span style="color:#e6db74">&#34;namespace&#34;</span>][<span style="color:#e6db74">&#34;name&#34;</span>]
            project_name <span style="color:#f92672">=</span> i[<span style="color:#e6db74">&#34;path&#34;</span>]
            project_id <span style="color:#f92672">=</span> i[<span style="color:#e6db74">&#34;id&#34;</span>]
            <span style="color:#66d9ef">for</span> branches <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>git<span style="color:#f92672">.</span>getbranches(project_id):
                    new_commit <span style="color:#f92672">=</span> branches[<span style="color:#e6db74">&#34;commit&#34;</span>][<span style="color:#e6db74">&#34;id&#34;</span>][:<span style="color:#ae81ff">8</span>]
                    branch_name <span style="color:#f92672">=</span> branches[<span style="color:#e6db74">&#34;name&#34;</span>]

                    <span style="color:#66d9ef">try</span>:
                        commit_in_sql <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>sql_select(branch_name, project_name)
                    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">TypeError</span>:
                        self<span style="color:#f92672">.</span>sql_insert(project_name, branch_name, new_commit)

                    <span style="color:#66d9ef">if</span> commit_in_sql <span style="color:#f92672">!=</span> new_commit:
                        get_commit_info <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>git<span style="color:#f92672">.</span>getrepositorycommit(project_id, new_commit)
                        <span style="color:#66d9ef">try</span>:
                            author_name <span style="color:#f92672">=</span> get_commit_info[<span style="color:#e6db74">&#34;author_name&#34;</span>]
                            author_email <span style="color:#f92672">=</span> get_commit_info[<span style="color:#e6db74">&#34;author_email&#34;</span>]
                            author_message <span style="color:#f92672">=</span> get_commit_info[<span style="color:#e6db74">&#34;title&#34;</span>]
                            commit_date <span style="color:#f92672">=</span> get_commit_info[<span style="color:#e6db74">&#34;created_at&#34;</span>]
                        <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">TypeError</span>:
                            <span style="color:#66d9ef">pass</span>

                        compare_url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">/</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">/</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">/compare/</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">...</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span>\
                                      (gitlab_url, group_name, project_name, check_commit, new_commit)
                        send_email <span style="color:#f92672">=</span> SendEmail()
                        msg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Commit Repo: </span><span style="color:#e6db74">%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Branch Name: </span><span style="color:#e6db74">%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">User: </span><span style="color:#e6db74">%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">User Mail: </span><span style="color:#e6db74">%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Commit Message: </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">Commit Time: </span><span style="color:#e6db74">%s</span><span style="color:#ae81ff">\n\n</span><span style="color:#e6db74">Diff URL: </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span>\
                              (project_name, branch_name, author_name, author_email, author_message, commit_date, compare_url)
                        send_email<span style="color:#f92672">.</span>main(msg)
                        self<span style="color:#f92672">.</span>sql_update(new_commit, branch_name, project_name)

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>(self):
        self<span style="color:#f92672">.</span>commits()


<span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
    Commit()<span style="color:#f92672">.</span>main()
</code></pre></div><p>Python scripti ile aynı yerde oluşturmanız gereken <strong>commits.sql</strong> dosyası dosyası.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">Commit Repo: githlab-email-repo
Branch Name: master
User: gokhan
User Mail: gokhan@mankara.org
Commit Message: First Test Email Commit
Commit Time: 2015-05-30T13:58:42.000+03:00
 
Diff URL: https://gitlab.domain.com/gokhan/gitlab-email-repo/compare/s1ws93...1ex4ng59
</code></pre></div><p>Gitlab server’da post-receive hook scriptine, başına <strong>/usr/bin/python</strong> koyarak scripti kullanabilirsiniz. Başına python path’ini koymamızın sebebi, gitlab’ın kendi python binary si olduğundan import ettiğimiz modüller gitlab’ın kendi lib’inde olmadığı için remote gitlab server’a push ettiğinizde “modül bulunamadı” şeklinde hata verecektir.</p>
<p><a href="https://github.com/gokhanm/gitlab-email-hook">Gitlab Repo</a></p>

              


            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://www.gokhanmankara.com/tags/gitlab/">gitlab</a>

  <a class="tag tag--primary tag--small" href="https://www.gokhanmankara.com/tags/gitlab-hook/">gitlab hook</a>

  <a class="tag tag--primary tag--small" href="https://www.gokhanmankara.com/tags/gitlab-send-email/">gitlab send email</a>

  <a class="tag tag--primary tag--small" href="https://www.gokhanmankara.com/tags/python/">python</a>

  <a class="tag tag--primary tag--small" href="https://www.gokhanmankara.com/tags/python-gitlab-hook/">python gitlab hook</a>

                  </div>
                
              
            
            
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://www.gokhanmankara.com/2015/03/xenserverda-sanal-sunucularin-gorunmemesi/" data-tooltip="Xenserver&#39;da Sanal Sunucuların Görünmemesi" aria-label="PREVIOUS: Xenserver&#39;da Sanal Sunucuların Görünmemesi">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://www.gokhanmankara.com/2015/08/screen-komutu-kullanimi/" data-tooltip="Screen Komutu Kullanımı" aria-label="NEXT: Screen Komutu Kullanımı">
          
              <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
  
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


            
  


          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2022 Gökhan MANKARA. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://www.gokhanmankara.com/2015/03/xenserverda-sanal-sunucularin-gorunmemesi/" data-tooltip="Xenserver&#39;da Sanal Sunucuların Görünmemesi" aria-label="PREVIOUS: Xenserver&#39;da Sanal Sunucuların Görünmemesi">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://www.gokhanmankara.com/2015/08/screen-komutu-kullanimi/" data-tooltip="Screen Komutu Kullanımı" aria-label="NEXT: Screen Komutu Kullanımı">
          
              <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
  
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="Back to top">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


      </div>
      

    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-times"></i>
    </div>
    
      <img id="about-card-picture" src="https://www.gravatar.com/avatar/d5d65b23744b836690ba8e789bbf1656?s=110" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">Gökhan MANKARA</h4>
    
      <div id="about-card-bio">Golang, Python, Blogger, Linux Fan</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Software Developer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker-alt"></i>
        <br/>
        Turkey/Istanbul
      </div>
    
  </div>
</div>

    

    
  
    
      
      <div id="cover" style="background-image:url('https://www.gokhanmankara.com/images/cover.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js" integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://www.gokhanmankara.com/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js"></script>



<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>




    
  </body>
</html>

